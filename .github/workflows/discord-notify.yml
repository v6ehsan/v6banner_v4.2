name: Discord Notification

on:
  push:
    branches:
      - main
  release:
    types: [published]

jobs:
  discord_notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Send Discord Notification
        uses: ilshidur/action-discord@0.4.0
        with:
          entryPoint: main.js
          args: |
            ${{ toJSON(
              contains(github.event_name, 'push') 
              ? {
                  content: "",
                  embeds: [
                    {
                      title: "üöÄ New Push on Repo: v6_banner",
                      description: "By **${{ github.actor }}**\nCommit: [${{ github.event.head_commit.id }}](${{ github.event.head_commit.url }})",
                      color: 5814783,
                      fields: [
                        {
                          name: "üìÇ Files Changed",
                          value: join(github.event.head_commit.modified, '\n') + '\n' + join(github.event.head_commit.added, '\n') + '\n' + join(github.event.head_commit.removed, '\n'),
                          inline: false
                        }
                      ],
                      footer: {
                        text: "v6 DeVzOnE - GitHub Notification 2025"
                      },
                      timestamp: "${{ github.event.head_commit.timestamp }}"
                    }
                  ]
                }
              : {
                  content: "",
                  embeds: [
                    {
                      title: "üè∑Ô∏è New Release Published: ${{ github.event.release.tag_name }}",
                      description: "By **${{ github.actor }}**\nRelease: [${{ github.event.release.name }}](${{ github.event.release.html_url }})",
                      color: 16753920,
                      footer: {
                        text: "v6 DeVzOnE - GitHub Release 2025"
                      },
                      timestamp: "${{ github.event.release.published_at }}"
                    }
                  ]
                }
            )}}
